<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Face Mesh Detector</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ml5@0.12.2/dist/ml5.min.js"></script>
  </head>
  <body>
    <script>
      let video;
      let facemesh;
      let predictions = [];

      function setup() {
        createCanvas(640, 480);
        video = createCapture(VIDEO);
        video.size(640, 480);
        video.hide();

        // âœ… Load FaceMesh model
        facemesh = ml5.facemesh(video, () =>
          console.log("FaceMesh model ready!")
        );

        // âœ… Listen for predictions
        facemesh.on("predict", (results) => (predictions = results));
      }

      function draw() {
        image(video, 0, 0, width, height);

        if (predictions.length > 0) {
          const keypoints = predictions[0].scaledMesh;

          // ðŸ”µ Draw blue dots for facial landmarks
          noStroke();
          fill(0, 150, 255);
          for (let i = 0; i < keypoints.length; i++) {
            const [x, y] = keypoints[i];
            ellipse(x, y, 3, 3);
          }

          // ðŸ”´ Draw red bounding box around the detected face
          let xs = keypoints.map((p) => p[0]);
          let ys = keypoints.map((p) => p[1]);
          let minX = Math.min(...xs);
          let maxX = Math.max(...xs);
          let minY = Math.min(...ys);
          let maxY = Math.max(...ys);

          stroke(255, 0, 0);
          strokeWeight(5);
          noFill();
          rect(minX - 10, minY - 10, maxX - minX + 20, maxY - minY + 20);

          // ðŸ§  Optional: show number of points detected
          noStroke();
          fill(255);
          textSize(16);
          text(`Points: ${keypoints.length}`, 10, height - 10);
        }
      }
    </script>
  </body>
</html>
